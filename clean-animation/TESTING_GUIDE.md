# Testing Guide - Asset Loading

## What Was Fixed

The animation now properly loads the original website's sphere models and textures:

### ‚úÖ Fixed Issues:
1. **Asset paths** - Corrected to use `sphere_l.buf`, `sphere_m.buf` instead of non-existent `cross.buf`
2. **BufLoader** - Created proper `.buf` binary file loader
3. **Graceful fallback** - Falls back to procedural geometry if assets fail to load
4. **Mobile optimization** - Automatically uses lower-detail models on mobile

### üìÅ Assets Included:
- `assets/models/sphere_l.buf` - Large/high detail (1.7KB) - **Used on desktop**
- `assets/models/sphere_m.buf` - Medium detail (1.1KB) - **Used on mobile**
- `assets/models/sphere_s.buf` - Small detail (744B)
- `assets/models/sphere_xs.buf` - Extra small (624B)
- `assets/textures/LDR_RGB1_0.png` - Blue noise texture (48KB)

## How to Test

### Method 1: Local Server (Recommended)

Since the code uses ES6 modules, you need a local server:

```bash
# Navigate to clean-animation folder
cd /home/user/Lumen-web/clean-animation

# Option A: Python 3
python3 -m http.server 8000

# Option B: Python 2
python -m SimpleHTTPServer 8000

# Option C: Node.js (if installed)
npx http-server -p 8000

# Option D: PHP
php -S localhost:8000
```

Then open: http://localhost:8000/

### Method 2: Simple Test Page

Open `test-simple.html` directly in your browser (doesn't use modules).

## What You Should See

### In Browser Console:

#### ‚úÖ Success (Assets Loaded):
```
Creating 20 sphere meshes...
Loading sphere geometry from: assets/models/sphere_l.buf
‚úì Sphere geometry loaded from .buf file
Scene Manager initialized
Post Effects initialized (simplified direct rendering)
Animation initialized successfully
Animation started
```

#### ‚ö†Ô∏è Fallback (Assets Failed):
```
Creating 20 sphere meshes...
Loading sphere geometry from: assets/models/sphere_l.buf
Failed to load .buf geometry, using procedural fallback: [error details]
‚úì Using procedural sphere geometry
Scene Manager initialized
...
```

### In the Viewport:

- **20+ floating spheres** of various colors (blue, white, black, etc.)
- **Smooth physics** - spheres orbit center point
- **Mouse interaction** - spheres repel from cursor
- **Scroll effects** - background distorts as you scroll
- **No 404 errors** in network tab

## Verify Asset Loading

### Chrome DevTools:
1. Press F12
2. Go to **Network** tab
3. Reload page (Ctrl+R)
4. Look for:
   - `sphere_l.buf` or `sphere_m.buf` - Status should be **200**
   - File size: ~1.7KB (large) or ~1.1KB (medium)

### Check Geometry:
Open console and type:
```javascript
// The geometry should have these attributes
console.log(animation.sphereRenderer.sphereMeshes[0].geometry.attributes);
```

**With .buf loaded:**
- `position`: Float32Array (from .buf file)
- `normal`: Float32Array
- `uv`: Float32Array (possibly)

**With procedural fallback:**
- `position`: Float32Array (generated by THREE.js)
- `normal`: Float32Array (generated)
- `uv`: Float32Array (generated)

## Troubleshooting

### Issue: 404 Errors on Assets

**Problem:** Console shows `Failed to load assets/models/sphere_l.buf: 404`

**Solutions:**
1. Make sure you're using a local server (not `file://`)
2. Check that assets are in the correct location:
   ```
   clean-animation/
   ‚îú‚îÄ‚îÄ assets/
   ‚îÇ   ‚îú‚îÄ‚îÄ models/
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sphere_l.buf ‚úì
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sphere_m.buf ‚úì
   ‚îÇ   ‚îî‚îÄ‚îÄ textures/
   ‚îÇ       ‚îî‚îÄ‚îÄ LDR_RGB1_0.png ‚úì
   ‚îú‚îÄ‚îÄ index.html
   ‚îî‚îÄ‚îÄ src/...
   ```
3. Verify file permissions: `ls -la clean-animation/assets/models/`

### Issue: CORS Errors

**Problem:** `Access to fetch at 'file://...' from origin 'null' has been blocked by CORS`

**Solution:** Must use a local HTTP server, not `file://` protocol.

### Issue: Animation Doesn't Start

**Problem:** Spheres don't appear, no console output

**Solutions:**
1. Check browser console for JavaScript errors
2. Verify Three.js is loading from CDN
3. Try `test-simple.html` which has fewer dependencies
4. Check browser supports WebGL: visit https://get.webgl.org/

### Issue: Slow Performance

**Problem:** Animation is laggy or low FPS

**Solutions:**
1. Check `config.js` - reduce sphere counts on mobile
2. Disable bloom effects (already disabled)
3. Use lower detail models (sphere_s.buf or sphere_xs.buf)
4. Reduce sphere count in config:
   ```javascript
   spheres: {
     counts: {
       coloredMatte: 2,  // Reduce from 3
       coloredGlossy: 2, // Reduce from 3
       ...
     }
   }
   ```

## Configuration Options

Edit `src/config.js` to customize:

### Use Different Sphere Models:
```javascript
assets: {
  models: {
    sphere: 'assets/models/sphere_s.buf',  // Smaller, faster
    sphereMobile: 'assets/models/sphere_xs.buf'
  }
}
```

### Disable Assets (Use Procedural):
```javascript
assets: {
  useExternalAssets: false  // Falls back to procedural geometry
}
```

### Adjust Sphere Count:
```javascript
spheres: {
  counts: {
    coloredMatte: 3,
    coloredGlossy: 3,
    whiteMatte: 3,
    // ... adjust as needed
  }
}
```

## Performance Comparison

| Geometry Type | Vertices | File Size | Performance |
|--------------|----------|-----------|-------------|
| sphere_xs.buf | ~200 | 624 bytes | ‚ö° Fastest |
| sphere_s.buf | ~400 | 744 bytes | üöÄ Fast |
| sphere_m.buf | ~600 | 1.1 KB | ‚ú® Good |
| sphere_l.buf | ~800 | 1.7 KB | üíé Best Quality |
| Procedural (32x32) | 1024 | 0 bytes | ‚≠ê Balanced |
| Procedural (16x16) | 256 | 0 bytes | ‚ö° Fast |

## Next Steps

### Want to add more assets?

1. **Matcap Textures** - For realistic materials (would require EXR loader)
2. **Blue Noise** - Already included but not yet used (for dithering)
3. **Custom Spheres** - Create your own .buf files using the format

### Want better effects?

1. Enable bloom (requires `three/addons/postprocessing`)
2. Add real paint effects (complex shader work)
3. Implement proper god rays

## Success Checklist

- [x] Assets copied to clean-animation folder
- [x] BufLoader created and working
- [x] Config updated with correct paths
- [x] Sphere-renderer loads .buf files
- [x] Fallback to procedural geometry works
- [x] No console errors
- [x] No 404 errors
- [x] Animation runs smoothly
- [x] Mouse interaction works
- [x] Scroll effects work

Your animation should now be using the original website's optimized sphere models! üéâ
